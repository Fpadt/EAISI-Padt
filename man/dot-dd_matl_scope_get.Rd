% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/duck-db_int.R, R/duckdb_int.R
\name{.da_matl_scope_get}
\alias{.da_matl_scope_get}
\title{Generate SQL for Scope Materials CTE}
\usage{
.da_matl_scope_get(.scope_prdh = SCOPE_PRDH, .con)

.da_matl_scope_get(.scope_prdh = SCOPE_PRDH, .con)
}
\arguments{
\item{.scope_prdh}{Character vector. The values to filter the \code{PRDH1} column.
Defaults to the global constant \code{SCOPE_PRDH}.}

\item{.con}{A database connection object. Used to safely parameterize SQL queries
via \code{glue::glue_sql}.}
}
\value{
A character string containing the SQL statement for the scope materials CTE.

A character string containing the SQL statement for the scope materials CTE.
}
\description{
Constructs a Common Table Expression (CTE) SQL string for scope materials.
This CTE selects distinct materials from a parquet file filtered by a condition
on the \code{PRDH1} column.

Constructs a Common Table Expression (CTE) SQL string for scope materials.
This CTE selects distinct materials from a parquet file filtered by a condition
on the \code{PRDH1} column.
}
\details{
This function dynamically constructs a SQL query using \code{glue::glue_sql},
ensuring that inputs are safely parameterized. The parquet file path for material
data is determined internally via \code{.fh_datasets_path_get}.

The returned SQL defines a Common Table Expression (CTE) named \code{SCOPE_MATL},
which filters materials from a parquet file based on the specified \code{PRDH1} values.

This function dynamically constructs a SQL query using \code{glue::glue_sql},
ensuring that inputs are safely parameterized. The parquet file path for material
data is determined internally via \code{.fh_datasets_path_get}.

The returned SQL defines a Common Table Expression (CTE) named \code{SCOPE_MATL},
which filters materials from a parquet file based on the specified \code{PRDH1} values.
}
\examples{
\dontrun{
# Example usage
sql <- .da_matl_scope_get(
  .scope_prdh = c("PRDH001", "PRDH002"),
  .con = my_db_connection
)
print(sql)
}

\dontrun{
# Example usage
sql <- .da_matl_scope_get(
  .scope_prdh = c("PRDH001", "PRDH002"),
  .con = my_db_connection
)
print(sql)
}

}
\keyword{internal}
